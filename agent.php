<?
/**
*Class Agent - P.W.S.M.
*Author Roman Shneer romanshneer@gmail.com
*1.02.2012
*Any changes at your risk and criminal responsibility
*Changes can stop working of monitored site!
*/
eval(base64_decode('Q2xhc3MgQWdlbnQNCnsNCnZhciAkZGIsJGRiX3R5cGUsJG9iamVjdCwkdGVtcGxhdGVzOw0KdmFyICRsZWdhbHByb2Nlc3M9dHJ1ZTsNCmZ1bmN0aW9uIEFnZW50KCkNCnsNCiRkaXI9JHRoaXMtPmZpbmRfYWdlbnRfbGlicmFyeSgpOw0KJHRoaXMtPmluY2x1ZGVfYWdlbnRfbGlicmFyeSgkZGlyKTsNCg0KICBpZigkdGhpcy0+bGVnYWxwcm9jZXNzKQ0KICB7DQogICR0aGlzLT5yZWdpc3Rlcl9hZ2VudCgpOw0KDQogICR0aGlzLT5sb2FkX3RlbXBsYXRlcygpOw0KDQogICR0aGlzLT5jaGtfcmVxdWVzdCgpOw0KICB9DQokdGhpcy0+a2lsbF9hZ2VudCgpOw0KfQ0KZnVuY3Rpb24gZGJfdW5sb2FkZWQoKQ0Kew0KJHRoaXMtPmxlZ2FscHJvY2Vzcz1mYWxzZTsNCnJldHVybiBmYWxzZTsNCn0NCmZ1bmN0aW9uIGtpbGxfYWdlbnQoKQ0Kew0KCWlmKCR0aGlzLT5kYl90eXBlPT0nbXlzcWwnKQ0KCXsNCglteXNxbF9jbG9zZSgkdGhpcy0+ZGIpOw0KCX1lbHNlaWYoJHRoaXMtPmRiX3R5cGU9PSdwb3N0Z3Jlc3FsJykNCgl7DQoJcGdfY2xvc2UoJHRoaXMtPmRiKTsNCgl9DQp1bnNldCgkdGhpcyk7DQp9DQpmdW5jdGlvbiBjaGtfcmVxdWVzdCgpDQp7DQogc3dpdGNoKCRfU0VSVkVSWydSRVFVRVNUX01FVEhPRCddKQ0KIHsNCiAJY2FzZSAnR0VUJzoNCglpZihjb3VudCgkX0dFVCkpJF9HRVQ9JHRoaXMtPmNoa192YXJpYWJsZXNfdmlhX3BhdHRlcm4oJF9HRVQsJF9TRVJWRVJbJ1JFUVVFU1RfTUVUSE9EJ10pOw0KIAllbHNlICR0aGlzLT5yZWdfcmVxdWVzdCgpOw0KIAlicmVhazsNCiAJY2FzZSAnUE9TVCc6DQogCWlmKGNvdW50KCRfUE9TVCkpJF9QT1NUPSR0aGlzLT5jaGtfdmFyaWFibGVzX3ZpYV9wYXR0ZXJuKCRfUE9TVCwkX1NFUlZFUlsnUkVRVUVTVF9NRVRIT0QnXSk7DQogCWVsc2UgJHRoaXMtPnJlZ19yZXF1ZXN0KCk7DQogCWJyZWFrOw0KIH0NCn0NCmZ1bmN0aW9uIHJlZ19iYWRfcmVxdWVzdCgkbmFtZSwkdmFsdWUsJG5ld192YWx1ZSwkdGVtcGxhdGUpDQp7DQokcGF0dGVybj0kdGVtcGxhdGUtPmNvZGU7DQokcmVhc29uPSJSZXF1ZXN0IDxiPiIuJHRoaXMtPlEoJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10pLiI8L2I+DQpCbG9ja2VkIHZhbHVlIDxiPiIuJG5hbWUuIjwvYj4gPSA8Yj4iLmh0bWxzcGVjaWFsY2hhcnMoJHZhbHVlKS4iPC9iPiB2aWEgcGF0dGVybiA8Yj4iLmh0bWxzcGVjaWFsY2hhcnMoJHBhdHRlcm4pLiI8L2I+DQpDaGFuZ2VkIHRvIDxiPiIuaHRtbHNwZWNpYWxjaGFycygkbmV3X3ZhbHVlKS4iPC9iPg0KIjsNCiRpZGQ9JHRoaXMtPlFVRVJZKCJJTlNFUlQgSU5UTyBwd3NtX3JlcXVlc3RzICh1cmwsbWV0aG9kLHF1ZXJ5X3N0cmluZyxyZWFzb24sc3RhdHVzLG9iamVjdF9pZCxjcmVhdGVkLHJlbW90ZV9hZGRyLHRlbXBsYXRlX2lkKSBWQUxVRVMgKCciLiR0aGlzLT5RKCRfU0VSVkVSWydSRVFVRVNUX1VSSSddKS4iJywnIi4kdGhpcy0+USgkX1NFUlZFUlsnUkVRVUVTVF9NRVRIT0QnXSkuIicsJyIuJHRoaXMtPlEoJF9TRVJWRVJbJ1FVRVJZX1NUUklORyddKS4iJywnIi4kdGhpcy0+USgkcmVhc29uKS4iJywxLCIuJHRoaXMtPm9iamVjdC0+aWQuIiwiLnRpbWUoKS4iLCciLiR0aGlzLT5RKCRfU0VSVkVSWydSRU1PVEVfQUREUiddKS4iJywiLiR0aGlzLT5RKCR0ZW1wbGF0ZS0+aWQpLiIpIik7DQp9DQpmdW5jdGlvbiByZWdfcmVxdWVzdCgkdmFyaWFibGVzPWFycmF5KCkpDQp7DQokbmFtZXM9YXJyYXlfa2V5cygkdmFyaWFibGVzKTsNCiRyZWFzb249IlJlcXVlc3QgQWNjZXB0ZWQiOw0KaWYoY291bnQoJHZhcmlhYmxlcykpJHJlYXNvbi49Ijxicj52YXJpYWJsZXMgYWNjZXB0ZWQ6PGJyPiI7DQpmb3JlYWNoKCRuYW1lcyBhcyAkbmFtZSl7JHJlYXNvbi49Ijxicj48Zm9udCBjb2xvcj0ncmVkJz4iLiRuYW1lLiI8L2ZvbnQ+Ijt9DQokc3FsPSJJTlNFUlQgSU5UTyBwd3NtX3JlcXVlc3RzICh1cmwsbWV0aG9kLHF1ZXJ5X3N0cmluZyxyZWFzb24sc3RhdHVzLG9iamVjdF9pZCxjcmVhdGVkLHJlbW90ZV9hZGRyKSBWQUxVRVMgKCciLiR0aGlzLT5RKCRfU0VSVkVSWydSRVFVRVNUX1VSSSddKS4iJywnIi4kdGhpcy0+USgkX1NFUlZFUlsnUkVRVUVTVF9NRVRIT0QnXSkuIicsJyIuJHRoaXMtPlEoJF9TRVJWRVJbJ1FVRVJZX1NUUklORyddKS4iJywnIi4kdGhpcy0+USgkcmVhc29uKS4iJywwLCIuJHRoaXMtPm9iamVjdC0+aWQuIiwiLnRpbWUoKS4iLCciLiR0aGlzLT5RKCRfU0VSVkVSWydSRU1PVEVfQUREUiddKS4iJykiOw0KJHRoaXMtPlFVRVJZKCRzcWwpOw0KfQ0KZnVuY3Rpb24gY2hrX3ZhcmlhYmxlc192aWFfcGF0dGVybigkdmFyaWFibGVzLCRtZXRob2QpDQp7DQppZihjb3VudCgkdmFyaWFibGVzKSkNCnsNCmZvcmVhY2goJHZhcmlhYmxlcyBhcyAkbmFtZT0+JHZhbHVlKQ0KCXsNCgkkdmFyc1skbmFtZV09JHZhbHVlOw0KCWlmKCR0aGlzLT50ZW1wbGF0ZXMpDQoJew0KCQlmb3JlYWNoKCR0aGlzLT50ZW1wbGF0ZXMgYXMgJHRlbXBsYXRlKQ0KCQl7CQkNCgkJaWYoJHRlbXBsYXRlLT5wcm90b2NvbD09JG1ldGhvZCkNCgkJew0KCQkgICRwYXR0ZXJuPSR0ZW1wbGF0ZS0+Y29kZTsNCgkJICBpZihzdHJpc3RyKCR2YWx1ZSwkcGF0dGVybil8fHN0cmlzdHIoJHZhbHVlLCIlIi5iaW4yaGV4KCRwYXR0ZXJuKSkpDQoJCQkgIHsNCgkJICAkbmV3X3ZhbHVlPXN1YnN0cigkdmFsdWUsMCxzdHJwb3MoJHZhbHVlLCRwYXR0ZXJuKSkuc3Vic3RyKCR2YWx1ZSxzdHJwb3MoJHZhbHVlLCRwYXR0ZXJuKStzdHJsZW4oJHBhdHRlcm4pLHN0cmxlbigkdmFsdWUpLXN0cnBvcygkdmFsdWUsJHBhdHRlcm4pK3N0cmxlbigkcGF0dGVybikpOw0KCQ0KCQkgICR2YXJzWyRuYW1lXT0kbmV3X3ZhbHVlOw0KCQkgICR0aGlzLT5yZWdfYmFkX3JlcXVlc3QoJG5hbWUsJHZhbHVlLCRuZXdfdmFsdWUsJHRlbXBsYXRlKTsNCgkJICAkdmFsdWU9JG5ld192YWx1ZTsNCgkJCSAgfQ0KCSAgCX0NCgkgIAl9DQoJfQ0KCX0NCn0NCg0KDQogIAkJaWYoIWlzc2V0KCRuZXdfdmFsdWUpKSR0aGlzLT5yZWdfcmVxdWVzdCgkdmFyaWFibGVzKTsNCnJldHVybiAkdmFyczsNCn0NCg0KZnVuY3Rpb24gc29ydF90ZW1wbGF0ZXNfdmlhX21ldGhvZCgkdGVtcGxhdGVzLCRtZXRob2QpDQp7DQoNCglpZigkdGVtcGxhdGVzKQ0KCXsNCglmb3JlYWNoKCR0ZW1wbGF0ZXMgYXMgJHRlbXBsYXRlKQ0KCQl7DQoJCQlpZigkdGVtcGxhdGUtPnByb3RvY29sPT0kbWV0aG9kKQ0KCQkJew0KCQkJCSRuZXdfdGVtcGxhdGVzW109JHRlbXBsYXRlLT5jb2RlOw0KCQkJfQ0KCQl9DQoJcmV0dXJuICRuZXdfdGVtcGxhdGVzOw0KCX0NCn0NCmZ1bmN0aW9uIGxvYWRfdGVtcGxhdGVzKCkNCnsNCmlmKCEkdGhpcy0+dGVtcGxhdGVzPSR0aGlzLT5nZXRjYWNoZSgpKQ0Kew0KJHNxbD0iU0VMRUNUIHB0LioNCkZST00gcHdzbV90ZW1wbGF0ZXNfb2JqZWN0cyBwdG8NCkxFRlQgSk9JTiBwd3NtX3RlbXBsYXRlcyBwdCBPTiBwdC5pZD1wdG8udGVtcGxhdGVfaWQNCldIRVJFIHB0by5vYmplY3RfaWQ9Ii4kdGhpcy0+USgkdGhpcy0+b2JqZWN0LT5pZD8kdGhpcy0+b2JqZWN0LT5pZDowKTsNCiR0aGlzLT50ZW1wbGF0ZXM9JHRoaXMtPkxJU1RfUSgkc3FsKTsNCiR0aGlzLT5jYWNoZWl0KCR0aGlzLT50ZW1wbGF0ZXMpOw0KfQ0KfQ0KZnVuY3Rpb24gY2FjaGVpdCgkdGVtcGxhdGVzKQ0Kew0KaWYoZnVuY3Rpb25fZXhpc3RzKCJtZW1jYWNoZV9jb25uZWN0IikpDQp7DQokbWVtY2FjaGVfb2JqID0gQG1lbWNhY2hlX2Nvbm5lY3QoJ2xvY2FsaG9zdCcsIDExMjExKTsNCmlmKCRtZW1jYWNoZV9vYmopbWVtY2FjaGVfc2V0KCRtZW1jYWNoZV9vYmosICdwc3NfdGVtcGxhdGVzJywgJHRlbXBsYXRlcywgMCwgMzApOw0KZWxzZXsgDQpyZXR1cm4gZmFsc2U7DQogIH0NCn0NCn0NCmZ1bmN0aW9uIGdldGNhY2hlKCkNCnsNCmlmKGZ1bmN0aW9uX2V4aXN0cygibWVtY2FjaGVfY29ubmVjdCIpKQ0Kew0KJG1lbWNhY2hlX29iaiA9IEBtZW1jYWNoZV9jb25uZWN0KCdsb2NhbGhvc3QnLCAxMTIxMSk7DQppZigkbWVtY2FjaGVfb2JqKQ0Kew0KJHJlc3VsdD1tZW1jYWNoZV9nZXQoJG1lbWNhY2hlX29iaiwgJ3Bzc190ZW1wbGF0ZXMnKTsNCnJldHVybiAkcmVzdWx0Ow0KfWVsc2V7DQpyZXR1cm4gZmFsc2U7DQp9DQp9DQp9DQpmdW5jdGlvbiByZWdpc3Rlcl9hZ2VudCgpDQp7DQogaWYoISR0aGlzLT5vYmplY3Q9JHRoaXMtPmNoa19hZ2VudF9vYmplY3RfcmVnaXN0cmF0aW9uKCRfU0VSVkVSWydTQ1JJUFRfRklMRU5BTUUnXSkpDQogew0KICR0aGlzLT5yZWdpc3Rlcl9hZ2VudF9vYmplY3RfcmVnaXN0cmF0aW9uKCRfU0VSVkVSWydTQ1JJUFRfRklMRU5BTUUnXSk7DQogJHRoaXMtPm9iamVjdD0kdGhpcy0+Y2hrX2FnZW50X29iamVjdF9yZWdpc3RyYXRpb24oJF9TRVJWRVJbJ1NDUklQVF9GSUxFTkFNRSddKTsNCiB9DQp9DQpmdW5jdGlvbiByZWdpc3Rlcl9hZ2VudF9vYmplY3RfcmVnaXN0cmF0aW9uKCRzb3VyY2UpDQp7DQokdGhpcy0+UVVFUlkoIklOU0VSVCBJTlRPIHB3c21fb2JqZWN0cwkgKG9iamVjdF9zb3VyY2UsIG9iamVjdF91cmwgLCBjcmVhdGVkKSBWQUxVRVMgKCciLiR0aGlzLT5RKCRzb3VyY2UpLiInLCciLiAkdGhpcy0+USgiaHR0cDovLyIuJF9TRVJWRVJbJ1NFUlZFUl9OQU1FJ10uIiIuJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10pLiInLCIudGltZSgpLiIpIik7DQp9DQpmdW5jdGlvbiBjaGtfYWdlbnRfb2JqZWN0X3JlZ2lzdHJhdGlvbigkc291cmNlKQ0Kew0KIHJldHVybiAkdGhpcy0+Uk9XX1EoIlNFTEVDVCAqIEZST00gcHdzbV9vYmplY3RzIFdIRVJFIG9iamVjdF9zb3VyY2U9JyIuJHRoaXMtPlEoJHNvdXJjZSkuIiciKTsNCn0NCiBmdW5jdGlvbiBmaW5kX2FnZW50X2xpYnJhcnkoKQ0KIHsNCiAkZmlsZXM9Z2V0X2luY2x1ZGVkX2ZpbGVzKCk7DQogZm9yZWFjaCgkZmlsZXMgYXMgJGZpbGUpDQogCXsNCiAJCWlmKHN0cnN0cigkZmlsZSwiYWdlbnQucGhwIikpDQogCQl7DQogICAgICAgIHJldHVybiBzdWJzdHIoJGZpbGUsMCxzdHJycG9zKCRmaWxlLCJhZ2VudC5waHAiKSk7DQogCQl9DQogCX0NCiB9DQogZnVuY3Rpb24gaW5jbHVkZV9hZ2VudF9saWJyYXJ5KCRkaXIpDQogew0KIAlpbmNsdWRlX29uY2UgJGRpci4iY29uZi9jb25maWcucGhwIjsNCiAgICAkdGhpcy0+ZGI9JHRoaXMtPmRiX2xvYWQoJGRiX3R5cGUsJGRiX2hvc3QsJGRiX25hbWUsJGRiX3VzZXIsJGRiX3Bhc3MpOw0KDQogfQ0KIGZ1bmN0aW9uIGRiX2xvYWQoJGRiX3R5cGUsJGRiX2hvc3QsJGRiX25hbWUsJGRiX3VzZXIsJGRiX3Bhc3N3b3JkKQ0KIHsNCiAkdGhpcy0+ZGJ0eXBlPSRkYl90eXBlOw0KIAlpZigkZGJfdHlwZT09J215c3FsJykNCiAJew0KCSAgaWYoJGNvbm49bXlzcWxfY29ubmVjdCgkZGJfaG9zdCwkZGJfdXNlciwkZGJfcGFzc3dvcmQpKQ0KCSAgew0KCSAgbXlzcWxfc2VsZWN0X2RiKCRkYl9uYW1lLCRjb25uKTsNCgkgIHJldHVybiAkY29ubjsNCgkgIH1lbHNlew0KCSAgcmV0dXJuICR0aGlzLT5kYl91bmxvYWRlZCgpOw0KCSAgfQ0KIAl9ZWxzZWlmKCRkYl90eXBlPT0ncG9zdGdyZXNxbCcpDQogCXsNCiAJJGRic3RyaW5nPSJob3N0PSIuJGRiX2hvc3QuIiBwb3J0PTU0MzIgZGJuYW1lPSIuJGRiX25hbWUuIiB1c2VyPSIuJGRiX3VzZXIuIiBwYXNzd29yZD0iLiRkYl9wYXNzd29yZDsNCg0KCSAgaWYoJGNvbm49QHBnX2Nvbm5lY3QoJGRic3RyaW5nKSkNCgkgIHsNCgkgIHJldHVybiAkY29ubjsNCgkgIH1lbHNlew0KCSAgcmV0dXJuICR0aGlzLT5kYl91bmxvYWRlZCgpOwkgIA0KCSAgfQ0KIAl9DQogfQ0KIGZ1bmN0aW9uIFJPV19RKCRzcWwpDQogew0KICRyZXN1bHQ9JHRoaXMtPlFVRVJZKCRzcWwpOw0KIGlmKCEkcmVzdWx0KXJldHVybiBmYWxzZTsNCiBpZigkdGhpcy0+ZGJ0eXBlPT0nbXlzcWwnKQ0KIAl7DQogICAgICRvYj1teXNxbF9mZXRjaF9vYmplY3QoJHJlc3VsdCk7DQogCX1lbHNlaWYoJHRoaXMtPmRidHlwZT09J3Bvc3RncmVzcWwnKQ0KIAl7DQogICAgJG9iPXBnX2ZldGNoX29iamVjdCgkcmVzdWx0KTsNCiAJfQ0KIAlyZXR1cm4gJG9iOw0KIH0NCiBmdW5jdGlvbiBMSVNUX1EoJHNxbCkNCiB7DQogJHJlc3VsdD0kdGhpcy0+UVVFUlkoJHNxbCk7DQogaWYoISRyZXN1bHQpcmV0dXJuIGZhbHNlOw0KIGlmKCR0aGlzLT5kYnR5cGU9PSdteXNxbCcpDQogCXsNCiAgICAgd2hpbGUoJG9iPW15c3FsX2ZldGNoX29iamVjdCgkcmVzdWx0KSkNCiAgICAgCSRvYmplY3RzW109JG9iOw0KIAl9ZWxzZWlmKCR0aGlzLT5kYnR5cGU9PSdwb3N0Z3Jlc3FsJykNCiAJew0KICAgIHdoaWxlKCRvYj1wZ19mZXRjaF9vYmplY3QoJHJlc3VsdCkpDQogICAgCSRvYmplY3RzW109JG9iOw0KIAl9DQogCXJldHVybiAoaXNzZXQoJG9iamVjdHMpPyRvYmplY3RzOmZhbHNlKTsNCg0KIH0NCiBmdW5jdGlvbiBRVUVSWSgkc3FsKQ0KIHsNCiBpZigkdGhpcy0+ZGJ0eXBlPT0nbXlzcWwnKQ0KIAl7DQogICAgICRyZXN1bHQ9bXlzcWxfcXVlcnkoJHNxbCwkdGhpcy0+ZGIpOw0KICAgICBpZigkcmVzdWx0PT1mYWxzZSlwcmludCAiPGRpdiBzdHlsZT0nY29sb3I6cmVkO2ZvbnQtd2VpZ2h0OmJvbGQ7Jz4iLm15c3FsX2Vycm9yKCkuJzwvZGl2Pic7DQogICAgIHJldHVybiAkcmVzdWx0Ow0KIAl9ZWxzZWlmKCR0aGlzLT5kYnR5cGU9PSdwb3N0Z3Jlc3FsJykNCiAJew0KICAgICByZXR1cm4gcGdfcXVlcnkoJHRoaXMtPmRiLAkkc3FsKTsNCiAJfQ0KIH0NCiBmdW5jdGlvbiBRKCRzcWwpDQogew0KIAlpZigkdGhpcy0+ZGJ0eXBlPT0nbXlzcWwnKQ0KIAl7DQogICAgIHJldHVybiBteXNxbF9lc2NhcGVfc3RyaW5nKCRzcWwpOw0KIAl9ZWxzZWlmKCR0aGlzLT5kYnR5cGU9PSdwb3N0Z3Jlc3FsJykNCiAJew0KICAgICByZXR1cm4gcGdfZXNjYXBlX3N0cmluZygkc3FsKTsNCiAJfQ0KIH0NCn0NCiRhPW5ldyBBZ2VudDs='));
?>